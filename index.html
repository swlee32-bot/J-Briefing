<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Joint Briefing</title>
    <meta name="theme-color" content="#2563eb">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <style>
        :root {
            --primary-color: #2563eb;
            --danger-color: #ef4444;
            --bg-color: #f1f5f9;
            --text-dark: #1e293b;
        }

        /* 1. í´ë“œ ì»¤ë²„í™”ë©´ ì „ìš© ê³ ì • ë ˆì´ì•„ì›ƒ (ê°€ë¡œ ìŠ¤í¬ë¡¤ ì™„ë²½ ì°¨ë‹¨, ìƒí•˜ ìŠ¤í¬ë¡¤ë§Œ í—ˆìš©) */
        html, body {
            overflow-x: hidden;
            width: 100%;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            font-family: 'Pretendard', -apple-system, sans-serif;
            overscroll-behavior-y: none; 
            -webkit-tap-highlight-color: transparent; 
        }
        body {
            padding: 8px; 
            box-sizing: border-box;
        }
        .checklist-container {
            background: white; 
            width: 100%; 
            padding: 15px 12px; 
            border-radius: 12px;
            box-sizing: border-box;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        /* 2. ì œëª© ë° ì„¹ì…˜ ì»¨í…Œì´ë„ˆ */
        h1 {
            color: var(--text-dark); text-align: center; font-size: 1.2rem;
            margin-top: 5px; margin-bottom: 20px; border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }
        .section {
            margin-bottom: 12px; border: 1px solid #e2e8f0;
            border-radius: 8px; overflow: hidden;
        }
        .section-header {
            background-color: #f8fafc; padding: 10px 12px;
            font-size: 0.95rem; font-weight: bold; color: var(--primary-color);
            border-bottom: 1px solid #e2e8f0;
        }
        .content { padding: 12px; }
        
        /* 3. í•­ëª© ìœ„ì•„ë˜ ë°°ì¹˜ (ì»¤ë²„í™”ë©´ ê°€ë¡œí­ 100% í™œìš©) */
        .row { 
            display: flex; 
            flex-direction: column; 
            margin-bottom: 12px; 
            gap: 6px; 
        }
        .row:last-child { margin-bottom: 0; }
        
        label {
            width: 100%;
            font-size: 0.85rem; color: #475569; font-weight: 700;
        }
        
        /* í„°ì¹˜í•˜ê¸° í¸í•˜ë„ë¡ ì…ë ¥ì¹¸ í¬ê¸° ëŒ€í­ ìƒí–¥ */
        input[type="text"], input[type="tel"], select, input[readonly] {
            width: 100%; border: 1px solid #cbd5e0; border-radius: 6px;
            padding: 12px 10px; 
            font-size: 0.95rem; background-color: white;
            box-sizing: border-box;
            appearance: none;
        }
        input[readonly] {
            background-color: #f8fafc; cursor: pointer; text-align: center;
            color: var(--primary-color); font-weight: bold;
        }

        /* 4. í¸ëª…/ê¸°ë²ˆ ë“± ì§§ì€ í•­ëª©ì€ ë°˜ë°˜(1:1) ê·¸ë¦¬ë“œë¡œ ê½‰ ì°¨ê²Œ ë°°ì¹˜ */
        .split-row { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; 
        }
        .split-item { display: flex; flex-direction: column; gap: 6px; }
        
        /* 5. ë‹¤ì´ì–¼ ì¸í’‹ ê·¸ë£¹ (ì‹œê°„, ê³ ë„) */
        .picker-group { display: flex; align-items: center; gap: 8px; width: 100%; }
        .separator { font-weight: bold; color: #64748b; }

        /* 6. ìŠ¹ë¬´ì› ì´ë¦„ ì…ë ¥ (2ì—´ ë°°ì¹˜) */
        .crew-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .crew-column { display: flex; flex-direction: column; gap: 6px; }
        .crew-label {
            text-align: center; font-size: 0.85rem; font-weight: bold; color: var(--primary-color);
            margin-bottom: 2px; background: #eff6ff; padding: 6px; border-radius: 4px;
        }

        /* 7. í•˜ë‹¨ ë²„íŠ¼ */
        .button-group { display: flex; gap: 10px; margin-top: 15px; }
        .btn {
            flex: 1; padding: 14px; border: none; border-radius: 8px;
            font-weight: bold; cursor: pointer; font-size: 1rem;
        }
        .btn-reset { background-color: var(--danger-color); color: white; }
        .btn:active { transform: scale(0.96); opacity: 0.8; }
        .footer { text-align: center; margin-top: 20px; font-size: 0.75rem; color: #94a3b8; padding-bottom: 20px; }

        /* =========================================
           [ë‹¤ì´ì–¼(Wheel) ëª¨ë‹¬ ì „ìš© CSS]
           ========================================= */
        .dial-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;
            backdrop-filter: blur(2px);
        }
        .dial-modal-content {
            background: white; width: 90%; max-width: 320px; border-radius: 16px; padding: 20px;
            box-sizing: border-box; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: modalPop 0.2s ease-out;
        }
        @keyframes modalPop {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .dial-modal-content h3 { margin: 0 0 15px 0; font-size: 1.1rem; color: var(--primary-color); }
        .dial-container {
            position: relative; display: flex; justify-content: center; align-items: center;
            height: 150px; overflow: hidden; background: #f8fafc; border-radius: 8px;
            border: 1px solid #e2e8f0; margin-bottom: 15px;
        }
        .dial-col {
            flex: 1; height: 100%; overflow-y: auto; scroll-snap-type: y mandatory;
            scrollbar-width: none; 
        }
        .dial-col::-webkit-scrollbar { display: none; } 
        .dial-item {
            height: 50px; display: flex; justify-content: center; align-items: center;
            font-size: 1.3rem; font-weight: bold; color: #cbd5e0; scroll-snap-align: center;
            transition: color 0.1s;
        }
        .dial-separator { font-size: 1.3rem; font-weight: bold; padding: 0 5px; z-index: 2; color: #64748b; }
        .dial-highlight {
            position: absolute; top: 50px; left: 0; width: 100%; height: 50px;
            background: rgba(37, 99, 235, 0.08); border-top: 2px solid var(--primary-color);
            border-bottom: 2px solid var(--primary-color); pointer-events: none;
        }
        .dial-btn-group { display: flex; gap: 10px; }
    </style>
</head>
<body>

<form id="briefingForm">
<div class="checklist-container">
    <h1>ğŸ¤ JOINT BRIEFING</h1>

    <div class="section">
        <div class="section-header">CREW</div>
        <div class="content">
            <div class="crew-grid">
                <div class="crew-column">
                    <div class="crew-label">CAPT</div>
                    <input type="text" name="capt1" placeholder="Name 1">
                    <input type="text" name="capt2" placeholder="Name 2">
                    <input type="text" name="capt3" placeholder="Name 3">
                </div>
                <div class="crew-column">
                    <div class="crew-label">F/O</div>
                    <input type="text" name="fo1" placeholder="Name 1">
                    <input type="text" name="fo2" placeholder="Name 2">
                    <input type="text" name="fo3" placeholder="Name 3">
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-header">ê¸°ë³¸ì •ë³´</div>
        <div class="content">
            <div class="split-row" style="margin-bottom: 12px;">
                <div class="split-item"><label>í¸ëª…</label><input type="tel" name="fltNo" placeholder="Flight No." inputmode="numeric"></div>
                <div class="split-item">
                    <label>ê¸°ë²ˆ</label>
                    <select name="tailNo">
                        <option value="">ì„ íƒ</option>
                        <option value="HL8387">HL8387</option>
                        <option value="HL8388">HL8388</option>
                        <option value="HL8389">HL8389</option>
                        <option value="HL8516">HL8516</option>
                        <option value="HL8517">HL8517</option>
                        <option value="HL8701">HL8701</option>
                        <option value="HL8702">HL8702</option>
                        <option value="HL8703">HL8703</option>
                        <option value="HL8704">HL8704</option>
                    </select>
                </div>
            </div>
            <div class="split-row">
                <div class="split-item"><label>Dep.G</label><input type="text" name="depGate" placeholder="Dep. Gate"></div>
                <div class="split-item"><label>Arr.G</label><input type="text" name="arrGate" placeholder="Arr. Gate"></div>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-header">ë¹„í–‰ì •ë³´ (ë‹¤ì´ì–¼ ì„ íƒ)</div>
        <div class="content">
            <div class="row">
                <label>ë¹„í–‰ì‹œê°„</label>
                <div class="picker-group">
                    <input type="text" id="fltHours" name="fltHours" readonly placeholder="00h" onclick="openDialModal('time')">
                    <span class="separator">:</span>
                    <input type="text" id="fltMins" name="fltMins" readonly placeholder="00m" onclick="openDialModal('time')">
                </div>
            </div>
            <div class="row">
                <label>ìˆœí•­ê³ ë„</label>
                <div class="picker-group">
                    <input type="text" id="altInitial" name="altInitial" readonly placeholder="FL250" onclick="openDialModal('alt')">
                    <span class="separator">~</span>
                    <input type="text" id="altFinal" name="altFinal" readonly placeholder="FL250" onclick="openDialModal('alt')">
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-header">ë‚ ì”¨ì •ë³´</div>
        <div class="content">
            <div class="row"><label>ì¶œë°œê³µí•­</label><input type="text" name="wxDep" placeholder="Departure WX"></div>
            <div class="row"><label>ë„ì°©ê³µí•­</label><input type="text" name="wxArr" placeholder="Destination WX"></div>
            <div class="row"><label>í•­ë¡œë‚œê¸°ë¥˜</label><input type="text" name="wxRoute" placeholder="En-route WX"></div>
        </div>
    </div>

    <div class="section">
        <div class="section-header">ì ˆì°¨</div>
        <div class="content">
            <div class="row">
                <label>ì¡°ì¢…ì‹¤ì¶œì…ì ˆì°¨</label>
                <input type="text" name="proc_entry" id="proc_entry" placeholder="ì¸í„°í°, ì»¤íŠ¼, ì²­ì •êµ¬ì—­í™•ì¸, 1E">
            </div>
            <div class="row">
                <label>STERILE COCKPIT</label>
                <input type="text" name="proc_sterile" id="proc_sterile" placeholder="PILOT ALERT - ë³„í‘œ 2ë²ˆ">
            </div>
            <div class="row">
                <label>ì´ë¥™ë‹¨ë…</label>
                <input type="text" name="proc_rto" id="proc_rto" placeholder="Attention Crew at Station, Remain Seated">
            </div>
            <div class="row">
                <label>ë¹„ìƒì‹œ ì¡°ì¢…ì‹¤ ì—°ë½</label>
                <input type="text" name="proc_emer" id="proc_emer" placeholder="ë¹„ìƒë²¨ 3íšŒ">
            </div>
            <div class="row">
                <label>SEATBELT Sign</label>
                <input type="text" name="proc_seatbelt" placeholder="1íšŒ/2íšŒ">
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-header">ê¸°íƒ€ì •ë³´</div>
        <div class="content">
            <div class="row"><label>íŠ¹ë³„ìŠ¹ê°</label><input type="text" name="etc_spax" placeholder="SPCP, VIP ë“±"></div>
            <div class="row"><label>ê°ì‹¤ê´€ë ¨ MEL</label><input type="text" name="etc_mel" placeholder="Cabin related MEL"></div>
            <div class="row">
                <label>í™•ì¸ì‚¬í•­</label>
                <input type="text" name="etc_confirm" id="etc_confirm" placeholder="ê±´ê°•ìƒíƒœ, SHOWUP, ì¦ëª…ì„œ">
            </div>
        </div>
    </div>

    <div class="button-group">
        <button type="button" class="btn btn-reset" onclick="resetChecklist()">ë¦¬ì…‹ (ì´ˆê¸°í™”)</button>
    </div>

    <div class="footer">
        Joint Briefing Checklist - Flight Operations & Cabin
    </div>
</div>
</form>

<div id="timeModal" class="dial-modal">
    <div class="dial-modal-content">
        <h3>ë¹„í–‰ì‹œê°„ ì„¤ì •</h3>
        <div class="dial-container">
            <div class="dial-col" id="dial-hours"></div>
            <div class="dial-separator">:</div>
            <div class="dial-col" id="dial-mins"></div>
            <div class="dial-highlight"></div>
        </div>
        <div class="dial-btn-group">
            <button type="button" class="btn" style="background:#cbd5e0; color:#1e293b;" onclick="closeDialModal('time')">ì·¨ì†Œ</button>
            <button type="button" class="btn" style="background:var(--primary-color); color:white;" onclick="confirmDialModal('time')">í™•ì¸</button>
        </div>
    </div>
</div>

<div id="altModal" class="dial-modal">
    <div class="dial-modal-content">
        <h3>ìˆœí•­ê³ ë„ ì„¤ì •</h3>
        <div class="dial-container">
            <div class="dial-col" id="dial-alt1"></div>
            <div class="dial-separator">~</div>
            <div class="dial-col" id="dial-alt2"></div>
            <div class="dial-highlight"></div>
        </div>
        <div class="dial-btn-group">
            <button type="button" class="btn" style="background:#cbd5e0; color:#1e293b;" onclick="closeDialModal('alt')">ì·¨ì†Œ</button>
            <button type="button" class="btn" style="background:var(--primary-color); color:white;" onclick="confirmDialModal('alt')">í™•ì¸</button>
        </div>
    </div>
</div>

<script>
    const STORAGE_KEY = 'joint_briefing_data';
    const form = document.getElementById('briefingForm');
    const DIAL_ITEM_HEIGHT = 50; 

    function init() {
        createDialItems('dial-hours', 0, 16, 1, v => String(v).padStart(2, '0') + 'h');
        createDialItems('dial-mins', 0, 55, 5, v => String(v).padStart(2, '0') + 'm');
        createDialItems('dial-alt1', 250, 410, 10, v => 'FL' + v);
        createDialItems('dial-alt2', 250, 410, 10, v => 'FL' + v);

        loadData();
        
        form.addEventListener('input', () => {
            saveToStorage();
        });
    }

    // =========================================
    // [ë‹¤ì´ì–¼ ëª¨ë‹¬ ì»¨íŠ¸ë¡¤ëŸ¬]
    // =========================================
    function createDialItems(containerId, min, max, step, formatFn) {
        const container = document.getElementById(containerId);
        container.innerHTML = '<div class="dial-item"></div>'; 
        for(let i = min; i <= max; i += step) {
            let div = document.createElement('div');
            div.className = 'dial-item';
            div.innerText = formatFn ? formatFn(i) : i;
            div.dataset.value = formatFn ? formatFn(i) : i;
            container.appendChild(div);
        }
        container.innerHTML += '<div class="dial-item"></div>'; 

        container.addEventListener('scroll', () => {
            let idx = Math.round(container.scrollTop / DIAL_ITEM_HEIGHT) + 1;
            let items = container.querySelectorAll('.dial-item');
            items.forEach(el => el.style.color = '#cbd5e0');
            if(items[idx]) items[idx].style.color = 'var(--primary-color)';
        });
    }

    function openDialModal(type) {
        if(type === 'time') {
            document.getElementById('timeModal').style.display = 'flex';
            setDialScroll('dial-hours', document.getElementById('fltHours').value || '00h');
            setDialScroll('dial-mins', document.getElementById('fltMins').value || '00m');
        } else if (type === 'alt') {
            document.getElementById('altModal').style.display = 'flex';
            setDialScroll('dial-alt1', document.getElementById('altInitial').value || 'FL250');
            setDialScroll('dial-alt2', document.getElementById('altFinal').value || 'FL250');
        }
    }

    function closeDialModal(type) {
        if(type === 'time') document.getElementById('timeModal').style.display = 'none';
        if(type === 'alt') document.getElementById('altModal').style.display = 'none';
    }

    function confirmDialModal(type) {
        if(type === 'time') {
            document.getElementById('fltHours').value = getDialValue('dial-hours');
            document.getElementById('fltMins').value = getDialValue('dial-mins');
        } else if (type === 'alt') {
            document.getElementById('altInitial').value = getDialValue('dial-alt1');
            document.getElementById('altFinal').value = getDialValue('dial-alt2');
        }
        closeDialModal(type);
        saveToStorage(); 
    }

    function setDialScroll(containerId, targetValue) {
        const container = document.getElementById(containerId);
        const items = container.querySelectorAll('.dial-item');
        let targetIdx = 1; 
        
        items.forEach((item, idx) => {
            if(item.dataset.value === targetValue) targetIdx = idx;
        });
        
        container.scrollTop = (targetIdx - 1) * DIAL_ITEM_HEIGHT;
        container.dispatchEvent(new Event('scroll')); 
    }

    function getDialValue(containerId) {
        const container = document.getElementById(containerId);
        let idx = Math.round(container.scrollTop / DIAL_ITEM_HEIGHT) + 1;
        const items = container.querySelectorAll('.dial-item');
        return items[idx] ? items[idx].dataset.value : '';
    }

    // =========================================
    // [ë°ì´í„° ì €ì¥ ë° ë¶ˆëŸ¬ì˜¤ê¸°]
    // =========================================
    function saveToStorage() {
        const formData = new FormData(form);
        const data = {};
        formData.forEach((value, key) => data[key] = value);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    function loadData() {
        const savedData = localStorage.getItem(STORAGE_KEY);
        if (savedData) {
            const data = JSON.parse(savedData);
            Object.keys(data).forEach(key => {
                const field = form.elements[key];
                if (field) field.value = data[key];
            });
        }
    }

    function resetChecklist() {
        if(confirm("ëª¨ë“  ì…ë ¥ ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            localStorage.removeItem(STORAGE_KEY);
            form.reset();
            
            // ğŸš¨ ì›ì¸ì´ì—ˆë˜ .value ê°•ì œ ì£¼ì… ì½”ë“œë¥¼ ì „ë¶€ ì‚­ì œí–ˆìŠµë‹ˆë‹¤!
            // ì´ì œ ë¦¬ì…‹ ì‹œ ë¹ˆì¹¸ì´ ë˜ë©°, HTMLì— ì ì–´ë‘” placeholder íŒíŠ¸ê°€ ìì—°ìŠ¤ëŸ½ê²Œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.
            document.getElementById('fltHours').value = "";
            document.getElementById('fltMins').value = "";
            document.getElementById('altInitial').value = "";
            document.getElementById('altFinal').value = "";
            
            saveToStorage();
        }
    }

    init();
</script>

<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('SW ë“±ë¡ ì„±ê³µ!', reg.scope))
                .catch(err => console.log('SW ë“±ë¡ ì‹¤íŒ¨:', err));
        });
    }
</script>
</body>
</html>